<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1">
    <title>Why you should have server MOTD (Message of the Day) on all your nodes and improving the team DevOps experience</title>
    <meta name="viewport" content="width=device-width">

    <script type="application/javascript" src="http://code.jquery.com/jquery-1.10.0.min.js"></script>
    <script type="application/javascript" src="https://eafdbc63c97ce6bec9ef-b0a668e5876bef6fe25684caf71db405.ssl.cf1.rackcdn.com/v1-latest/canon.min.js"></script>
    <link rel="stylesheet" type="text/css" href="https://eafdbc63c97ce6bec9ef-b0a668e5876bef6fe25684caf71db405.ssl.cf1.rackcdn.com/v1-latest/canon.min.css">

    <!-- syntax highlighting CSS -->
    <link rel="stylesheet" href="/css/syntax.css">
    <link rel="stylesheet" href="/css/custom.css">

    <script type="text/javascript">
      var _gaq = _gaq || [];
      _gaq.push(['_setAccount', 'UA-49052230-1']);
      _gaq.push(['_trackPageview']);

      (function() {
        var ga = document.createElement('script'); ga.type = 'text/javascript'; ga.async = true;
        ga.src = ('https:' == document.location.protocol ? 'https://ssl' : 'http://www') + '.google-analytics.com/ga.js';
        var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(ga, s);
      })();
    </script>
  </head>
  <body class="rs-responsive">
    <div class="rs-wrapper">

      <!-- Top nav / header -->
      <div class="rs-nav-utility rs-fixed-top">
        <ul class="rs-nav">
          <li class="rs-nav-item">
            <a class="rs-nav-link" href="/">Home</a>
          </li>
          <li class="rs-nav-item">
            <a class="rs-nav-link" href="/about.html">About me</a>
          </li>
          <li class="rs-nav-item"><a class="rs-nav-link" href="https://github.com/riltsken">Github</a></li>
          <li class="rs-nav-item"><a class="rs-nav-link" href="https://twitter.com/rilt">Twitter</a></li>
        </ul>
      </div>
      <div class="rs-push"></div>
      <div class="rs-nav-primary">
        <ul class="rs-nav">
          <li class="rs-nav-item">
            <h2 class="rs-page-title">Bridging the gap - A blog about DevOps and Software Development</h2>
          </li>
        </ul>
      </div>


      <!-- Main page / blog content -->
      <div class="rs-body">
        <div class="rs-main">
            <div class="rs-content">
              <div class="rs-inner">
                <h3>Why you should have server MOTD (Message of the Day) on all your nodes and improving the team DevOps experience</h3>
<p>16 Mar 2014</p>
<div class="rs-row post-content">
  <div class="span-6">
    <p>&#8291;
<div class="rs-panel rs-content">
  <div class="rs-detail-header">
    <div class="rs-detail-header-title">The problem</div>
  </div>
  <div class="rs-inner">
    <p>
      Our Infrastructure team for the Cloud Control Panel at Rackspace has around ~200 public cloud servers across production, preproduction, staging, and test environments. At a high level our general layout for hosting the Cloud Control Panel includes nodes of several different types. We have load balancers running apache. Web nodes which serve the base content with django. Javascript served from a cdn (content delivery network). Twisted servers which proxy requests for making calls to Rackspace apis from the frontend. A cluster of Cassandra nodes for managing sessions, preferences, and api cache data. All of these nodes are managed and provisioned using <a href="https://github.com/tobami/littlechef">littlechef</a> (chef-solo) combined with <a href="https://github.com/tildedave/littlechef-rackspace">littlechef-rackspace</a>.
    </p>
    <p>
      When I first started working on this team we had almost no documentation about how the different types of servers in our environment were setup. When you would SSH onto a node to debug an issue or alert it would take a little extra digging to get started. While we do use chef for configuration of our servers it would take awhile to trace all of the different recipes, where they install services, what scripts you can run, and other useful information about that node. Another issue is making sure that developers at all levels have access to the same information. We want to make sure all, from junior to senior, developers are able to tackle issues that arise.
    </p>
    <p>
      To that end <a href="https://github.com/AMeng">Alex Meng</a> one of the developers on the team took it upon himself during a hackday to improve the process. He did this by generating MOTD&#39;s for our servers via chef. This is a Cassandra node in our environment. The MOTD is great for immediately being able to start diagnosing issues without having to look at chef for where everything on this node is located.
    </p>
    <img src="http://b7cc86bc05773bcecd41-4057535a55b255b6cbfb486a61b5692d.r49.cf1.rackcdn.com/reach_cass_motd.png" alt="Example of a Cassandra node MOTD in our test environment. Full picture." />
  </div>
</div>
<div class="rs-panel rs-content">
  <div class="rs-detail-header">
    <div class="rs-detail-header-title">Load and network information</div>
  </div>
  <div class="rs-inner">
    <img src="http://b7cc86bc05773bcecd41-4057535a55b255b6cbfb486a61b5692d.r49.cf1.rackcdn.com/reach_cass_motd_1.png" alt="Top of MOTD describing load and network interfaces. Cropped.">
    <p>
    When you first ssh into a node the very top shows some basic <strong>load information</strong> about the node and what <strong>network interfaces</strong> it has available. The network interfaces has proven useful if you have services running on different interfaces and need quick access to that information. For example, on this cassandra node we would access the cassandra cli (cqlsh) from the private network interface.
    </p>
  </div>
</div>
<div class="rs-panel rs-content">
  <div class="rs-detail-header">
    <div class="rs-detail-header-title">Node description</div>
  </div>
  <div class="rs-inner">
    <img src="http://b7cc86bc05773bcecd41-4057535a55b255b6cbfb486a61b5692d.r49.cf1.rackcdn.com/reach_cass_motd_2.png" alt="Middle of MOTD describing project name, node name, environment, hostname, and region. Cropped." />
    <p>
      The next piece of information we add is our <strong>project name</strong> along with the <strong>node name</strong> (cassandra, load balancer, proxy, web), <strong>region</strong> (dfw, ord, syd), <strong>environment</strong> (test, staging, preprod, production) and <strong>hostname</strong> which is blurred out. This helps a person ensure they know they are on the right node. The environment text is large so people are more careful if they are jumping on several boxes, some of which could be production.
    </p>
  </div>
</div>
<div class="rs-panel rs-content">
  <div class="rs-detail-header">
    <div class="rs-detail-header-title">Services and location of important information</div>
  </div>
  <div class="rs-inner">
    <img src="http://b7cc86bc05773bcecd41-4057535a55b255b6cbfb486a61b5692d.r49.cf1.rackcdn.com/reach_cass_motd_3.png" alt="Middle of MOTD describing project name, node name, environment, hostname, and region. Cropped." />
    <p>
    The next section describes the <strong>services running</strong> on the box. This one only happens to be running Cassandra, but some nodes might be running multiple services (in general, our nodes are assigned a single function, but some applications require multiple services on a box). It will also describe where <strong>logs</strong> and <strong>important configuration</strong> files are located on the node. Other things we include sometimes on here are location of <strong>script files</strong> or <strong>cron jobs</strong> that are running on the system. At the end of our MOTD is a link to the <strong>documentation</strong> which describes in detail the role of this node in our architecture.
    </p>
  </div>
</div>
<div class="rs-panel rs-content">
  <div class="rs-detail-header">
    <div class="rs-detail-header-title">Conclusion</div>
  </div>
  <div class="rs-inner">
    <p>
    Our implementation of MOTD&#39;s is done via a chef recipe. All of our nodes have a &quot;short_name&quot; attribute which we use to identify which MOTD to use. We store these MOTD&#39;s as cookbook files and every node has a MOTD recipe which dumps the correct MOTD onto that node.
    </p>
    <p>
    In the past year that we have had MOTD&#39;s on all of our nodes I realize how important and helpful it is to disperse information about our architecture and make it easier to enable other developers to operate on it. The MOTD provides one key piece for organizing this information immediately when acting on a single node.
    </p>
  </div>
</div></p>

  </div>
</div>


              </div>
            </div>
        </div>
      </div>

      <div class="rs-push"></div>
    </div>

    <!-- Footer -->
    <div class="rs-nav-footer">
      <div class="rs-container">
        <ul class="rs-nav">
          <li class="rs-nav-item">Samuel Toriel</li>
        </ul>
      </div>
    </div>

  </body>
</html>
